rand <- round(rnorm(50, mean = 0, sd = 1), digits = 1)
hist(rand,freq = F, main = "", xlab = "", xlim = c(-3,3))
points(rand,rep(0,50),pch = "l")
curve(dnorm(x,0,1),add = T,col = "red")
legend(x = "topright",lty = 1 ,
col = "red",legend = "True Density",cex = 0.8)
rand <- round(rnorm(50, mean = 0, sd = 1), digits = 1)
hist(rand,freq = F, main = "", xlab = "", xlim = c(-3,3))
points(rand,rep(0,50),pch = "l")
curve(dnorm(x,0,1),add = T,col = "red")
legend(x = "topright",lty = 1 ,
col = "red",legend = "True Density",cex = 0.8)
estimated <- density(rand)
hist(rand,freq = F,main="",xlab = "",xlim = c(-3,3))
lines(estimated,col = "blue")
curve(dnorm(x,0,1),add = T,col = "red")
legend(x = "topright",lty = 1, col = c("red","blue"),legend = c("True Density","Estimated Density"),cex = 0.8)
head(data.frame(x = estimated$x, y = estimated$y))
y <- seq(-5, 5, 0.1)
plot(y, dnorm(y, mean=0, sd=1), type = "l")
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school]) %>%
mutate(Y=rnorm(450,a+b*X,30)) %>%
select(X,pref,school,Y)-> st_df
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school]) %>%
mutate(Y=rnorm(450,a+b*X,30)) %>%
select(X,pref,school,Y)-> st_df
st_df %>% head()
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school]) %>%
mutate(Y=rnorm(450,a+b*X,30)) %>%
select(X,pref,school,Y)-> st_df
st_df %>% head()
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school]) %>%
mutate(Y=rnorm(450,a+b*X,30)) %>%
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df %>%
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df %>%
filter(pref=="1") %>%
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df %>%
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df %>%
filter(pref=="1") %>%
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df %>%
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df %
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
install.packages("ggplot2")
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df %>%
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df %
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df %>%
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df %
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
install.packages("ggplot2")
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
install.packages(c("dplyr", "ggplot2"))
install.packages("ggplot2")
library(ggplot2)
library(dplyr)
set.seed(1234)
X <- rnorm(450,40,10)
N_pre <- c(200,150,100)
N_st1 <- c(rep(30,5),20,20,10)
N_st2 <- c(30,30,20,20,20,20,10)
N_st3 <- c(50,30,20)
N_st <- c(N_st1,N_st2,N_st3)
pref <- rep(1:3,times=N_pre)
school <- rep(1:length(N_st), times=N_st)
a0 <- 50
b0 <- 20
a_pre <- rnorm(3, mean=a0, sd=100)
b_pre <- rnorm(3, mean=b0, sd=10)
a <- rnorm(length(N_st), mean=rep(a_pre,c(8,7,3)), sd=50)
b <- rnorm(length(N_st), mean=rep(b_pre,c(8,7,3)), sd=5)
data_frame(X=X,school = as.factor(school),pref = as.factor(pref),
a=a[school],b=b[school])
mutate(Y=rnorm(450,a+b*X,30))
select(X,pref,school,Y)-> st_df
# グラフ化
#都道府県ごと
st_df
ggplot(aes(x=X,y=Y,col=pref))+
geom_point(alpha = 0.5)+
geom_smooth(method = "lm",se=F)
#都道府県1の学校ごと
st_df
filter(pref=="1")
ggplot(aes(x=X,y=Y,col=school))+
geom_point()+
geom_smooth(method = "lm",se=F)
## Setting the global code chunk options ##
# Args
#   comment='': won't append any string to the start of each line of results
#   fig.align='center': align figures to the center of document
knitr::opts_chunk$set(comment="", fig.align="center")
y <- 0:8
p <- dbinom(y, max(y), prob = 0.1)
plot(y, p, type = "n", xlab = "y", ylab = "p(y |8, q)")
for (q in c(0.1, 0.3, 0.8)) {
p <- dbinom(y, max(y), prob = q)
lines(y, p, type = "b", col = rgb(0, 0, 0, min(q + 0.3, 1)), lwd = 2, pch = 16)
}
legend("topright", legend = c(0.1, 0.3, 0.6), pch = c(21, 23, 24), title = "q")
logistic <- function(z) 1 / (1 + exp(-z))
z <- seq(-5, 5, 0.1)
plot(z, logistic(z), type = "l", xlab = "z", ylab = "q")
abline(v = 0, lty = 2)
xx <- seq(-3, 3, 0.1)
cols <- c("#118ab6", "#212198", "#af13a4")
# left
plot(xx, logistic(0 + 2 * xx), type = "l", lwd = 2, col = cols[1], ylim = c(0, 1), yaxs = "i", xlab = "x", ylab = "q", main = "beta_2 = 2")
lines(xx, logistic(2 + 2 * xx), lwd = 2, col = cols[2])
lines(xx, logistic(-3 + 2 * xx), lwd = 2, col = cols[3])
legend("topleft", legend = c(0, 2, -3), col = cols, lwd = 2, title = "beta_1")
# right
plot(xx, logistic(0 + 2 * xx), type = "l", lwd = 2, col = cols[1], ylim = c(0, 1), yaxs = "i", xlab = "x", ylab = "q", main = "beta_1 = 0")
lines(xx, logistic(0 + 4 * xx), lwd = 2, col = cols[2])
lines(xx, logistic(0 - 1 * xx), lwd = 2, col = cols[3])
legend("left", legend = c(2, 4, -1), col = cols, lwd = 2, title = "beta_1")
d <- read.csv("../data/data6a.csv")
d <- read.csv("../data/data6a.csv")
ls
setwd("~/Desktop")
setwd("~/Desktop/play_R")
